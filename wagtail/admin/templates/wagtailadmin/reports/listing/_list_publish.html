{% extends "wagtailadmin/reports/listing/_list_page_report.html" %}

{% load i18n wagtailadmin_tags %}

{% block extra_columns %}
    <th>{% trans 'Scheduled by' %}</th>
    <th>{% trans 'Scheduled to be published' %}</th>
{% endblock %}


{% block extra_page_data %}
    <td valign="top">
        {% with user=page.get_latest_revision.user %}
        {% avatar user=user size="small" %}
        <a href="{% url 'wagtailusers_users:edit' user.pk %}">{{ user|user_display_name }}</a>
        {% endwith %}
    </td>
    <td valign="top">
        {% page_permissions page as perms %}
        <p>
            <b>{{ page.get_latest_revision.approved_go_live_at|date:"DATETIME_FORMAT" }}</b>
        </p>
        {% if perms.can_publish %}
            <form action="{% url 'wagtailadmin_scheduled_pages:publish_scheduled_confirm' page_id=page.pk %}" method="post">
                {% csrf_token %}
                <input type="hidden" name="next" value="{{ request.path }}">
                <button type="submit" class="button button-secondary button-small">{% trans 'Publish now' %}</button>
            </form>
        {% endif %}
    </td>
{% endblock %}